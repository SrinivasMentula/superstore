trigger: none

pool:
  name: Default

steps:
  # Step 1 - Verify Databricks CLI is available
  - pwsh: |
      databricks --version
    displayName: 'Check Databricks CLI Version'

  # Step 2 - Validate the bundle
  - pwsh: |
      databricks bundle validate --target Test --profile QAspn-authentication
    displayName: 'Validate Bundle'
    workingDirectory: $(Build.SourcesDirectory)/superstore/DABDemo

  # Step 3 - Deploy the bundle to Test workspace
  - pwsh: |
      databricks bundle deploy --target Test --profile QAspn-authentication
    displayName: 'Deploy Bundle to Test'
    workingDirectory: $(Build.SourcesDirectory)/superstore/DABDemo